<div class="container py-5">
  
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h2 class="fw-bold text-primary mb-0">üìÖ Agenda de Citas</h2>
      <p class="text-muted">Gestiona las reservas de tu peluquer√≠a</p>
    </div>
    <a [routerLink]="['/peluqueria', peluqueriaId]" class="btn btn-outline-secondary">
      &larr; Volver al Detalle
    </a>
  </div>

  @if(loading){
  <div class="text-center py-5">
    <div class="spinner-border text-primary" role="status"></div>
    <p class="mt-2">Cargando agenda...</p>
  </div>
  }

  @if(!loading){
  <div class="card shadow border-0">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead class="bg-light">
          <tr>
            <th class="py-3 ps-4">Fecha / Hora</th>
            <th class="py-3">Cliente</th>
            <th class="py-3">Servicio</th>
            <th class="py-3">Estado / Acciones</th>
            <th class="py-3">Precio</th>
            <th class="py-3">Contacto</th>
          </tr>
        </thead>
        <tbody>
          @for (res of reservas; track res.id){
          <tr>
            <!-- Fecha y Hora -->
            <td class="ps-4">
              <div class="fw-bold text-dark">{{ res.fecha }}</div>
              <div class="text-primary small fw-bold">üïí {{ res.hora }}</div>
            </td>
            
            <!-- Nombre del Cliente -->
            <td>
              <div class="fw-bold">{{ res.nombreCliente }}</div>
            </td>

            <!-- Nombre del Servicio -->
            <td>
              <span class="badge bg-info text-dark">{{ res.nombreServicio }}</span>
            </td>
            
            <td class="text-center">
              @switch (res.estado) {
                    
                    @case ('PENDIENTE') {
                      <div class="btn-group shadow-sm" role="group">
                        <button class="btn btn-sm btn-success" (click)="aceptar(res)" title="Aceptar Cita">
                          ‚úî
                        </button>
                        <button class="btn btn-sm btn-danger" (click)="rechazar(res)" title="Rechazar Cita">
                          ‚úñ
                        </button>
                      </div>
                    }

                    @case ('CONFIRMADA') {
                      <span class="badge bg-success p-2">
                        ‚úÖ Aceptada
                      </span>
                    }

                    @case ('CANCELADA') {
                      <span class="badge bg-secondary p-2">
                        ‚ùå Rechazada
                      </span>
                    }
                  }
                </td>

            <td class="fw-bold text-success">
              {{ res.precioServicio }}‚Ç¨
            </td>

            <td>
              <a href="mailto:{{res.emailCliente}}" class="btn btn-sm btn-outline-primary" title="Enviar correo">
                ‚úâÔ∏è 
              </a>
            </td>
          </tr>
        }@empty {  <!-- Si no hay reservas, equivale a *ngIf="reservas.length === 0" -->
          <tr>
            <td colspan="6" class="text-center py-5 text-muted">
              üì≠ No tienes reservas pendientes.
            </td>
          </tr>
        }
        </tbody>
      </table>
    </div>
  </div>
}
</div>
